%% 60 
a='exp3_kuskus_60.csv';
P_P_60_1=P_P(8000,9700,a)  ;  P_P_60_2=P_P(11500,13100,a);P_P_60_3=P_P(14500,16200,a)  ;  P_P_60_4=P_P(18000,19600,a);
P_P_60_5=P_P(21500,23000,a);  P_P_60_6=P_P(25000,26500,a);P_P_60_7=P_P(28400,29600,a);  P_P_60_8=P_P(31500,32800,a);
P_P_60_9=P_P(3500,36500,a);  P_P_60_10=P_P(38600,39600,a);
X_60 = [P_P_60_1(1:1);P_P_60_2(1:1);P_P_60_3(1:1);P_P_60_4(1:1);P_P_60_5(1:1);P_P_60_6(1:1);P_P_60_7(1:1);P_P_60_8(1:1);P_P_60_9(1:1);P_P_60_10(1:1)];
Y_60 =[P_P_60_1(2:2);P_P_60_2(2:2);P_P_60_3(2:2);P_P_60_4(2:2);P_P_60_5(2:2);P_P_60_6(2:2);P_P_60_7(2:2);P_P_60_8(2:2);P_P_60_9(2:2);P_P_60_10(2:2)];

%% 80
a='exp3_kuskus_80.csv';
P_P_80_1=P_P(4000,5800,a)  ;  P_P_80_2=P_P(6400,7400,a);P_P_80_3=P_P(8600,9700,a)  ;  P_P_80_4=P_P(11200,12200,a);
P_P_80_5=P_P(13800,14600,a);  P_P_80_6=P_P(16200,17200,a);P_P_80_7=P_P(18600,19600,a);  P_P_80_8=P_P(21200,22200,a);
P_P_80_9=P_P(23500,24600,a);  P_P_80_10=P_P(25800,27100,a);
X_80 = [P_P_80_1(1:1);P_P_80_2(1:1);P_P_80_3(1:1);P_P_80_4(1:1);P_P_80_5(1:1);P_P_80_6(1:1);P_P_80_7(1:1);P_P_80_8(1:1);P_P_80_9(1:1);P_P_80_10(1:1)];
Y_80 =[P_P_80_1(2:2);P_P_80_2(2:2);P_P_80_3(2:2);P_P_80_4(2:2);P_P_80_5(2:2);P_P_80_6(2:2);P_P_80_7(2:2);P_P_80_8(2:2);P_P_80_9(2:2);P_P_80_10(2:2)];

%% 100 %25674
a='exp3_kuskus_100.csv';
P_P_100_1=P_P(6400,7300,a)  ; P_P_100_2=P_P(8200,9200,a);P_P_100_3=P_P(10000,11400,a); P_P_100_4=P_P(12200,13200,a);
P_P_100_5=P_P(14200,15200,a); P_P_100_6=P_P(16200,17200,a);P_P_100_7=P_P(18200,19200,a); P_P_100_8=P_P(20000,21200,a);
P_P_100_9=P_P(22000,23200,a); P_P_100_10=P_P(24000,25000,a);
X_100 = [P_P_100_1(1:1);P_P_100_2(1:1);P_P_100_3(1:1);P_P_100_4(1:1);P_P_100_5(1:1);P_P_100_6(1:1);P_P_100_7(1:1);P_P_100_8(1:1);P_P_100_9(1:1);P_P_100_10(1:1)];
Y_100 =[P_P_100_1(2:2);P_P_100_2(2:2);P_P_100_3(2:2);P_P_100_4(2:2);P_P_100_5(2:2);P_P_100_6(2:2);P_P_100_7(2:2);P_P_100_8(2:2);P_P_100_9(2:2);P_P_100_10(2:2)];

%% 120 %17671
a='exp3_kuskus_120.csv';
P_P_120_1=P_P(2000,3400,a)  ; P_P_120_2=P_P(3800,5000,a);P_P_120_3=P_P(5400,6400,a); P_P_120_4=P_P(7000,8000,a);
P_P_120_5=P_P(8600,9500,a); P_P_120_6=P_P(10200,11200,a);P_P_120_8=P_P(13400,14400,a);P_P_120_9=P_P(14800,16000,a); P_P_120_10=P_P(16600,17600,a);
X_120 = [P_P_120_1(1:1);P_P_120_2(1:1);P_P_120_3(1:1);P_P_120_4(1:1);P_P_120_5(1:1);P_P_120_6(1:1);P_P_120_8(1:1);P_P_120_9(1:1);P_P_120_10(1:1)];
Y_120 =[P_P_120_1(2:2);P_P_120_2(2:2);P_P_120_3(2:2);P_P_120_4(2:2);P_P_120_5(2:2);P_P_120_6(2:2);P_P_120_8(2:2);P_P_120_9(2:2);P_P_120_10(2:2)];

%% 140 %16189
a='exp3_kuskus_140.csv';
P_P_140_5=P_P(7900,8900,a); P_P_120_6=P_P(9500,10200,a);P_P_140_7=P_P(10800,11600,a);
P_P_140_8=P_P(12200,12900,a);P_P_140_9=P_P(13600,14300,a); P_P_120_10=P_P(14900,15700,a);
X_140 = [P_P_140_5(1:1);P_P_120_6(1:1);P_P_140_7(1:1);P_P_140_8(1:1);P_P_140_9(1:1);P_P_120_10(1:1)];
Y_140 =[P_P_140_5(2:2);P_P_120_6(2:2);P_P_140_7(2:2);P_P_140_8(2:2);P_P_140_9(2:2);P_P_120_10(2:2)];
%% 60_fasol
a='exp4_fasol_60.csv';
P_P_60_1f=P_P(1500,5200,a)  ;  P_P_60_2f=P_P(7000,10400,a);
P_P_60_3f=P_P(13000,16500,a)  ;  P_P_60_4f=P_P(19000,23000,a);
P_P_60_5f=P_P(25000,28500,a);  P_P_60_6f=P_P(31000,34500,a);
P_P_60_7f=P_P(37000,40500,a);  P_P_60_8f=P_P(42500,45500,a);
P_P_60_9f=P_P(47000,53000,a);  P_P_60_10f=P_P(55000,57800,a);
X_60f = [P_P_60_1f(1:1);P_P_60_2f(1:1);P_P_60_3f(1:1);P_P_60_4f(1:1);P_P_60_5f(1:1);P_P_60_6f(1:1);P_P_60_7f(1:1);P_P_60_8f(1:1);P_P_60_9f(1:1);P_P_60_10f(1:1)];
Y_60f =[P_P_60_1f(2:2);P_P_60_2f(2:2);P_P_60_3f(2:2);P_P_60_4f(2:2);P_P_60_5f(2:2);P_P_60_6f(2:2);P_P_60_7f(2:2);P_P_60_8f(2:2);P_P_60_9f(2:2);P_P_60_10f(2:2)];

%%
%X=[X_80; X_100];
%Y=[Y_80; Y_100];
%scatter(X,Y);
hold on
scatter(X_60,Y_60,'c'); 
scatter(X_80,Y_80,'r');
scatter(X_100,Y_100,'b');
scatter(X_120,Y_120,'g');
scatter(X_140,Y_140,'m');
scatter(X_60f,Y_60f,'k','x');
%plot(X_60,Y_60,'c');
legend('60k','80k','100k','120k','140k','60k');
%%
function dif = P_P(A,B,C) % A - lowerbound B- upperbound C-csv fie name
a=csvread(C, A, 3,[A,3,B,3]);%17671
p=csvread(C, A, 2,[A,2,B,2]);
maxV=max(p);
ind=find(p==maxV, 1);
deltaP=p(ind:ind)-p(1:1);
dif= deltaP./(ind);
y=a-mean(a);y=detrend(y);
Fs = 8000;
Fnorm = 5/(Fs/2); % Normalized frequency
df = designfilt('highpassiir',...
               'PassbandFrequency',Fnorm,...
               'FilterOrder',2,...
               'PassbandRipple',1,...
               'StopbandAttenuation',100);
z = filter(df,y);
L=length(z);
NFFT = 2^nextpow2(L); % Next power of 2 from length of y
Y = fft(z,NFFT)/L;
f = Fs/2*linspace(0,1,NFFT/2+1);
%plot(f,2*abs(Y(1:NFFT/2+1)));
P=2*abs(Y(1:NFFT/2+1));
S = sum(P)/length(f);
dif = [dif S];
end
